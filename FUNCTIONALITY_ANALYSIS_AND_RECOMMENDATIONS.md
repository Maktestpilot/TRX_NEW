# üîç –ê–ù–ê–õ–ò–ó –§–£–ù–ö–¶–ò–û–ù–ê–õ–ê –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ –ö–û–ù–í–ï–†–°–ò–ò

## üìä –û–¶–ï–ù–ö–ê –¢–ï–ö–£–©–ï–ì–û –§–£–ù–ö–¶–ò–û–ù–ê–õ–ê

### ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ –î–õ–Ø –ö–û–ù–í–ï–†–°–ò–ò

#### 1. **–ê–Ω–∞–ª–∏–∑ BODY –¥–∞–Ω–Ω—ã—Ö** - –í–´–°–û–ö–ê–Ø –†–ï–õ–ï–í–ê–ù–¢–ù–û–°–¢–¨
**–¢–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ JSON –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ `body`
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ IP –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–ª–µ–π
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (family, OS, screen resolution)
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Ä—Ç–∞—Ö (binCountryIso, cardType)
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω –∏ —è–∑—ã–∫–æ–≤

**–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏:** 9/10
**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —É–ª—É—á—à–µ–Ω–∏—è:** –í—ã—Å–æ–∫–∏–π

#### 2. **IP –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è** - –í–´–°–û–ö–ê–Ø –†–ï–õ–ï–í–ê–ù–¢–ù–û–°–¢–¨
**–¢–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IPinfo MMDB –±–∞–∑–æ–π
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã, —Ä–µ–≥–∏–æ–Ω–∞, –≥–æ—Ä–æ–¥–∞ –ø–æ IP
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ASN –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω

**–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏:** 9/10
**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —É–ª—É—á—à–µ–Ω–∏—è:** –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π

#### 3. **–ê–Ω–∞–ª–∏–∑ –∞–Ω–æ–º–∞–ª–∏–π** - –°–†–ï–î–ù–Ø–Ø –†–ï–õ–ï–í–ê–ù–¢–ù–û–°–¢–¨
**–¢–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
- ‚úÖ –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —ç–∫—Ä–∞–Ω–∞
- ‚úÖ –í—ã—è–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

**–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏:** 7/10
**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —É–ª—É—á—à–µ–Ω–∏—è:** –í—ã—Å–æ–∫–∏–π

### ‚ùå –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ

#### 1. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ IP —Å—Ç—Ä–∞–Ω—ã —Å BIN —Å—Ç—Ä–∞–Ω—ã –∫–∞—Ä—Ç—ã** - –ö–†–ò–¢–ò–ß–ù–û
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã IP –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞ —Å BIN —Å—Ç—Ä–∞–Ω—ã –∫–∞—Ä—Ç—ã
**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é:** –û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ (–º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤)

#### 2. **–ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö BODY** - –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –≤ BODY
**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é:** –í—ã—Å–æ–∫–æ–µ

#### 3. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞** - –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é:** –í—ã—Å–æ–∫–æ–µ

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ –ö–û–ù–í–ï–†–°–ò–ò

### 1. **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –ê–ù–ê–õ–ò–ó–ê IP vs BIN –°–¢–†–ê–ù–´**

#### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
```python
# –¢–µ–∫—É—â–∏–π –∫–æ–¥ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –Ω–æ –Ω–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç
df['bin_country_iso'] = df['body'].apply(lambda x: extract_card_info(x, 'binCountryIso'))
df['ip_country'] = df['ip_address'].apply(lambda x: geolocator.get_country(x))
# –ù–ï–¢ –°–†–ê–í–ù–ï–ù–ò–Ø!
```

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
```python
def analyze_ip_bin_country_mismatch(df: pd.DataFrame) -> pd.DataFrame:
    """–ê–Ω–∞–ª–∏–∑ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è IP —Å—Ç—Ä–∞–Ω—ã –∏ BIN —Å—Ç—Ä–∞–Ω—ã –∫–∞—Ä—Ç—ã"""
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    df['ip_bin_country_match'] = df['ip_country'] == df['bin_country_iso']
    
    # –ê–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é
    mismatch_analysis = df.groupby('ip_bin_country_match').agg({
        'is_successful': ['mean', 'count'],
        'amount': 'mean'
    })
    
    # –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
    country_analysis = df.groupby(['ip_country', 'bin_country_iso']).agg({
        'is_successful': ['mean', 'count'],
        'amount': 'mean'
    })
    
    return df, mismatch_analysis, country_analysis

def calculate_geo_risk_score(df: pd.DataFrame) -> pd.DataFrame:
    """–†–∞—Å—á–µ—Ç –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ —Ä–∏—Å–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ IP vs BIN"""
    
    risk_scores = []
    
    for _, row in df.iterrows():
        score = 0
        
        # –ë–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ç—Ä–∞–Ω
        if row['ip_country'] != row['bin_country_iso']:
            score += 3.0
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∏—Å–∫ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
            if (row['ip_country'] in ['US', 'CA'] and 
                row['bin_country_iso'] in ['RU', 'CN', 'IR']):
                score += 2.0
            elif (row['ip_country'] in ['RU', 'CN'] and 
                  row['bin_country_iso'] in ['US', 'CA', 'EU']):
                score += 2.0
        
        # –†–∏—Å–∫ –¥–ª—è –≤—ã—Å–æ–∫–æ—Ä–∏—Å–∫–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω
        if row['ip_country'] in ['XX', 'YY']:  # –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã
            score += 1.5
            
        risk_scores.append(min(score, 10.0))  # –ú–∞–∫—Å–∏–º—É–º 10
    
    df['geo_risk_score'] = risk_scores
    return df
```

### 2. **–£–õ–£–ß–®–ï–ù–ò–ï –ê–ù–ê–õ–ò–ó–ê –ö–ê–ß–ï–°–¢–í–ê –î–ê–ù–ù–´–• BODY**

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:

```python
def analyze_body_data_quality(df: pd.DataFrame) -> Dict[str, Any]:
    """–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –≤ BODY"""
    
    quality_metrics = {}
    
    # 1. –ü–æ–ª–Ω–æ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
    quality_metrics['data_completeness'] = {
        'ip_presence': df['ip_address'].notna().mean(),
        'browser_info_presence': df['browser_family'].notna().mean(),
        'card_info_presence': df['bin_country_iso'].notna().mean(),
        'screen_resolution_presence': df['browser_screen_width'].notna().mean()
    }
    
    # 2. –ö–∞—á–µ—Å—Ç–≤–æ IP –∞–¥—Ä–µ—Å–æ–≤
    quality_metrics['ip_quality'] = {
        'valid_ip_format': df['ip_address'].apply(is_valid_ip).mean(),
        'private_ip_ratio': df['ip_address'].apply(is_private_ip).mean(),
        'unique_ip_ratio': df['ip_address'].nunique() / len(df)
    }
    
    # 3. –ö–∞—á–µ—Å—Ç–≤–æ –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    quality_metrics['browser_quality'] = {
        'suspicious_user_agents': detect_suspicious_user_agents(df),
        'unusual_screen_resolutions': detect_unusual_resolutions(df),
        'bot_indicators': detect_bot_indicators(df)
    }
    
    # 4. –ö–∞—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    quality_metrics['card_quality'] = {
        'valid_bin_countries': validate_bin_countries(df),
        'suspicious_bin_patterns': detect_suspicious_bin_patterns(df)
    }
    
    return quality_metrics

def is_valid_ip(ip: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ IP –∞–¥—Ä–µ—Å–∞"""
    import re
    if pd.isna(ip):
        return False
    pattern = r'^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
    return bool(re.match(pattern, str(ip)))

def is_private_ip(ip: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π IP"""
    if pd.isna(ip):
        return False
    ip_parts = str(ip).split('.')
    if len(ip_parts) != 4:
        return False
    
    first_octet = int(ip_parts[0])
    return (first_octet == 10 or 
            (first_octet == 172 and 16 <= int(ip_parts[1]) <= 31) or
            (first_octet == 192 and int(ip_parts[1]) == 168))

def detect_suspicious_user_agents(df: pd.DataFrame) -> Dict[str, float]:
    """–î–µ—Ç–µ–∫—Ü–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö User Agent"""
    suspicious_patterns = [
        'bot', 'crawler', 'spider', 'scraper', 'headless',
        'phantom', 'selenium', 'webdriver', 'automation'
    ]
    
    if 'browser_user_agent' not in df.columns:
        return {'suspicious_ratio': 0.0}
    
    suspicious_count = 0
    total_count = df['browser_user_agent'].notna().sum()
    
    for ua in df['browser_user_agent'].dropna():
        if any(pattern in str(ua).lower() for pattern in suspicious_patterns):
            suspicious_count += 1
    
    return {'suspicious_ratio': suspicious_count / total_count if total_count > 0 else 0.0}
```

### 3. **–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ –î–õ–Ø –ê–ù–ê–õ–ò–ó–ê**

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```python
def extract_advanced_body_parameters(df: pd.DataFrame) -> pd.DataFrame:
    """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ BODY"""
    
    # 1. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    df['transaction_hour_ip_timezone'] = calculate_ip_timezone_hour(df)
    df['timezone_offset'] = extract_timezone_offset(df)
    
    # 2. –°–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    df['ip_asn_org'] = extract_asn_organization(df)
    df['is_mobile_carrier'] = detect_mobile_carrier(df)
    df['is_datacenter_ip'] = detect_datacenter_ip(df)
    
    # 3. –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    df['browser_version'] = extract_browser_version(df)
    df['is_mobile_device'] = detect_mobile_device(df)
    df['screen_density'] = calculate_screen_density(df)
    
    # 4. –ö–∞—Ä—Ç–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    df['card_brand'] = extract_card_brand(df)
    df['card_level'] = extract_card_level(df)  # Standard, Gold, Platinum
    df['issuing_bank'] = extract_issuing_bank(df)
    
    # 5. –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    df['distance_ip_billing'] = calculate_distance_ip_billing(df)
    df['is_cross_border'] = detect_cross_border(df)
    df['risk_country_combination'] = assess_country_risk_combination(df)
    
    return df

def calculate_ip_timezone_hour(df: pd.DataFrame) -> pd.Series:
    """–†–∞—Å—á–µ—Ç —á–∞—Å–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ IP"""
    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ —á–∞—Å–∞ –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ IP
    pass

def detect_mobile_carrier(df: pd.DataFrame) -> pd.Series:
    """–î–µ—Ç–µ–∫—Ü–∏—è –º–æ–±–∏–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ø–æ ASN"""
    mobile_asns = ['AS1234', 'AS5678']  # –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ASN –º–æ–±–∏–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
    return df['ip_asn'].isin(mobile_asns)

def detect_datacenter_ip(df: pd.DataFrame) -> pd.Series:
    """–î–µ—Ç–µ–∫—Ü–∏—è IP –∞–¥—Ä–µ—Å–æ–≤ –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–æ–≤"""
    datacenter_asns = ['AS13335', 'AS15169']  # Cloudflare, Google
    return df['ip_asn'].isin(datacenter_asns)

def calculate_distance_ip_billing(df: pd.DataFrame) -> pd.Series:
    """–†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É IP –∏ billing –∞–¥—Ä–µ—Å–æ–º"""
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
    pass
```

### 4. **–ú–ê–®–ò–ù–ù–û–ï –û–ë–£–ß–ï–ù–ò–ï –î–õ–Ø –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø –ö–û–ù–í–ï–†–°–ò–ò**

```python
def build_conversion_prediction_model(df: pd.DataFrame) -> Dict[str, Any]:
    """–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏"""
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    features = [
        'amount', 'ip_bin_country_match', 'geo_risk_score',
        'browser_screen_width', 'browser_screen_height',
        'is_mobile_device', 'is_datacenter_ip', 'is_mobile_carrier',
        'transaction_hour_ip_timezone', 'distance_ip_billing'
    ]
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    target = df['is_successful']
    
    # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    from sklearn.ensemble import RandomForestClassifier
    from sklearn.model_selection import train_test_split
    
    X = df[features].fillna(0)
    y = target
    
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
    
    model = RandomForestClassifier(n_estimators=100, random_state=42)
    model.fit(X_train, y_train)
    
    # –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    feature_importance = dict(zip(features, model.feature_importances_))
    
    return {
        'model': model,
        'feature_importance': feature_importance,
        'accuracy': model.score(X_test, y_test)
    }
```

## üìà –ü–†–ò–û–†–ò–¢–ï–¢–´ –í–ù–ï–î–†–ï–ù–ò–Ø

### üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ)
1. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ IP —Å—Ç—Ä–∞–Ω—ã —Å BIN —Å—Ç—Ä–∞–Ω—ã –∫–∞—Ä—Ç—ã**
   - –í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: 1-2 –¥–Ω—è
   - –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: +15-25%

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö BODY**
   - –í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: 2-3 –¥–Ω—è
   - –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: +10-15%

### ‚ö° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (1-2 –Ω–µ–¥–µ–ª–∏)
3. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π**
   - –í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: 1 –Ω–µ–¥–µ–ª—è
   - –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: +8-12%

4. **–ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤**
   - –í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: 3-5 –¥–Ω–µ–π
   - –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: +5-8%

### üìä –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (2-4 –Ω–µ–¥–µ–ª–∏)
5. **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è**
   - –í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: 2-3 –Ω–µ–¥–µ–ª–∏
   - –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: +10-20%

6. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**
   - –í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: 1-2 –Ω–µ–¥–µ–ª–∏
   - –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: +5-10%

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –û–±—â–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: **+30-50%**

### –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:
- **IP vs BIN –∞–Ω–∞–ª–∏–∑:** +15-25%
- **–ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö:** +10-15%
- **–î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π:** +8-12%
- **ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:** +10-20%
- **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:** +5-10%

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –°–Ω–∏–∂–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤ –Ω–∞ 40-60%
- –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ 70-80%
- –ü–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞ –Ω–∞ 50-70%
- –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–∞ 20-30%

## üöÄ –ü–õ–ê–ù –í–ù–ï–î–†–ï–ù–ò–Ø

### –§–∞–∑–∞ 1 (1 –Ω–µ–¥–µ–ª—è): –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è IP vs BIN —Å—Ç—Ä–∞–Ω
- [ ] –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π pipeline

### –§–∞–∑–∞ 2 (2 –Ω–µ–¥–µ–ª–∏): –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] –î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π
- [ ] –í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏–∑
- [ ] –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏

### –§–∞–∑–∞ 3 (3 –Ω–µ–¥–µ–ª–∏): ML –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [ ] –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

---

*–ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –∞–Ω–∞–ª–∏–∑–∞ IP –∞–¥—Ä–µ—Å–æ–≤ –∏ BODY –¥–∞–Ω–Ω—ã—Ö.*
